sqlplus id2241002148/id2241002148@//172.30.16.99/ora11g

----------------1----------------

----------------structure----------------
-- 1. customer
-- 2. Branch
-- 3. account
-- 4. Depositor
-- 5. Loan
-- 6. Installment 
-----------------------------------------
create table customer(cust_no varchar2(5) primary key check(cust_no like 'C%'), name varchar2(30) not null, phone_no number(10), city varchar2(15) not null);

create table branch(branch_code varchar2(5) primary key, branch_name varchar2(30) not null, branch_city varchar2(10), check(branch_city in ('DELHI','MUMBAI','KOLKATA','CHENNAI')));

create table account(account_no varchar2(5) primary key check(account_no like 'A%'), type varchar2(10), check(type in('SB','FD','CA')), balance number(10) check(balance>10000000),branch_code varchar2(6), foreign key(branch_code) references branch(branch_code));

--------------------------------------------------------------

-- Assignment 4: Table Creation using Database Constraints
-- Subject Code: CSE 3151

-- Drop existing tables (if needed for re-run)
DROP TABLE INSTALLMENT CASCADE CONSTRAINTS;
DROP TABLE LOAN CASCADE CONSTRAINTS;
DROP TABLE DEPOSITOR CASCADE CONSTRAINTS;
DROP TABLE ACCOUNT CASCADE CONSTRAINTS;
DROP TABLE CUSTOMER CASCADE CONSTRAINTS;
DROP TABLE BRANCH CASCADE CONSTRAINTS;

-- Create BRANCH table
CREATE TABLE BRANCH (
    BRANCH_CODE VARCHAR2(5) PRIMARY KEY,
    BRANCH_NAME VARCHAR2(50) NOT NULL,
    BRANCH_CITY VARCHAR2(20) CHECK (BRANCH_CITY IN ('DELHI', 'MUMBAI', 'KOLKATA', 'CHENNAI'))
);

-- Create CUSTOMER table
CREATE TABLE CUSTOMER (
    CUST_NO VARCHAR2(5) PRIMARY KEY CHECK (REGEXP_LIKE(CUST_NO, '^C.{4}$')),
    NAME VARCHAR2(50) NOT NULL,
    PHONE_NO VARCHAR2(15),
    CITY VARCHAR2(30) NOT NULL
);

-- Create ACCOUNT table
CREATE TABLE ACCOUNT (
    ACCOUNT_NO VARCHAR2(5) PRIMARY KEY CHECK (REGEXP_LIKE(ACCOUNT_NO, '^A.{4}$')),
    TYPE VARCHAR2(2) CHECK (TYPE IN ('SB', 'FD', 'CA')),
    BALANCE NUMBER CHECK (BALANCE < 10000000),
    BRANCH_CODE VARCHAR2(5),
    FOREIGN KEY (BRANCH_CODE) REFERENCES BRANCH(BRANCH_CODE)
);

-- Create DEPOSITOR table
CREATE TABLE DEPOSITOR (
    CUST_NO VARCHAR2(5),
    ACCOUNT_NO VARCHAR2(5),
    PRIMARY KEY (CUST_NO, ACCOUNT_NO),
    FOREIGN KEY (CUST_NO) REFERENCES CUSTOMER(CUST_NO),
    FOREIGN KEY (ACCOUNT_NO) REFERENCES ACCOUNT(ACCOUNT_NO)
);

-- Create LOAN table
CREATE TABLE LOAN (
    LOAN_NO VARCHAR2(5) PRIMARY KEY CHECK (REGEXP_LIKE(LOAN_NO, '^L.{4}$')),
    CUST_NO VARCHAR2(5),
    AMOUNT NUMBER CHECK (AMOUNT > 1000),
    BRANCH_CODE VARCHAR2(5),
    FOREIGN KEY (CUST_NO) REFERENCES CUSTOMER(CUST_NO),
    FOREIGN KEY (BRANCH_CODE) REFERENCES BRANCH(BRANCH_CODE)
);

-- Create INSTALLMENT table
CREATE TABLE INSTALLMENT (
    INST_NO NUMBER CHECK (INST_NO <= 10),
    LOAN_NO VARCHAR2(5),
    INST_AMOUNT NUMBER NOT NULL,
    PRIMARY KEY (INST_NO, LOAN_NO),
    FOREIGN KEY (LOAN_NO) REFERENCES LOAN(LOAN_NO)
);

-- Insert data into BRANCH
INSERT INTO BRANCH VALUES ('B001', 'JANAKPURI BRANCH', 'DELHI');
INSERT INTO BRANCH VALUES ('B002', 'CHANDNICHOWK BRANCH', 'DELHI');
INSERT INTO BRANCH VALUES ('B003', 'JUHU BRANCH', 'MUMBAI');
INSERT INTO BRANCH VALUES ('B004', 'ANDHERI BRANCH', 'MUMBAI');
INSERT INTO BRANCH VALUES ('B005', 'SALTLAKE BRANCH', 'KOLKATA');
INSERT INTO BRANCH VALUES ('B006', 'SRIRAMPURAM BRANCH', 'CHENNAI');

-- Insert data into CUSTOMER
INSERT INTO CUSTOMER VALUES ('C0001', 'RAJ ANAND SINGH', '9861258466', 'DELHI');
INSERT INTO CUSTOMER VALUES ('C0002', 'ANKITA SINGH', '9879958651', 'BANGALORE');
INSERT INTO CUSTOMER VALUES ('C0003', 'SOUMYA JHA', '9885623344', 'MUMBAI');
INSERT INTO CUSTOMER VALUES ('C0004', 'ABHIJIT MISHRA', '9455845425', 'MUMBAI');
INSERT INTO CUSTOMER VALUES ('C0005', 'YASH SARAF', '9665854585', 'KOLKATA');
INSERT INTO CUSTOMER VALUES ('C0006', 'SWAROOP RAY', '9437855466', 'CHENNAI');
INSERT INTO CUSTOMER VALUES ('C0007', 'SURYA NARAYAN PRADHAN', '9937955212', 'GURGAON');
INSERT INTO CUSTOMER VALUES ('C0008', 'PRANAV PRAVEEN', '9336652441', 'PUNE');
INSERT INTO CUSTOMER VALUES ('C0009', 'STUTI MISRA', '7870266534', 'DELHI');
INSERT INTO CUSTOMER VALUES ('C0010', 'ASLESHA TIWARI', NULL, 'MUMBAI');

-- Insert data into ACCOUNT
INSERT INTO ACCOUNT VALUES ('A0001', 'SB', 200000, 'B003');
INSERT INTO ACCOUNT VALUES ('A0002', 'SB', 15000, 'B002');
INSERT INTO ACCOUNT VALUES ('A0003', 'CA', 850000, 'B004');
INSERT INTO ACCOUNT VALUES ('A0004', 'CA', 35000, 'B004');
INSERT INTO ACCOUNT VALUES ('A0005', 'FD', 28500, 'B005');
INSERT INTO ACCOUNT VALUES ('A0006', 'FD', 550000, 'B005');
INSERT INTO ACCOUNT VALUES ('A0007', 'SB', 48000, 'B001');
INSERT INTO ACCOUNT VALUES ('A0008', 'SB', 7200, 'B002');
INSERT INTO ACCOUNT VALUES ('A0009', 'SB', 18750, 'B003');
INSERT INTO ACCOUNT VALUES ('A0010', 'FD', 99000, 'B004');

-- Insert data into DEPOSITOR
INSERT INTO DEPOSITOR VALUES ('C0003', 'A0001');
INSERT INTO DEPOSITOR VALUES ('C0004', 'A0001');
INSERT INTO DEPOSITOR VALUES ('C0004', 'A0002');
INSERT INTO DEPOSITOR VALUES ('C0006', 'A0003');
INSERT INTO DEPOSITOR VALUES ('C0006', 'A0004');
INSERT INTO DEPOSITOR VALUES ('C0001', 'A0005');
INSERT INTO DEPOSITOR VALUES ('C0002', 'A0005');
INSERT INTO DEPOSITOR VALUES ('C0010', 'A0006');
INSERT INTO DEPOSITOR VALUES ('C0009', 'A0007');
INSERT INTO DEPOSITOR VALUES ('C0008', 'A0008');
INSERT INTO DEPOSITOR VALUES ('C0007', 'A0009');
INSERT INTO DEPOSITOR VALUES ('C0006', 'A0010');

-- Insert data into LOAN
INSERT INTO LOAN VALUES ('L0001', 'C0005', 3000000, 'B006');
INSERT INTO LOAN VALUES ('L0002', 'C0001', 50000, 'B005');
INSERT INTO LOAN VALUES ('L0003', 'C0002', 8000000, 'B004');
INSERT INTO LOAN VALUES ('L0004', 'C0010', 100000, 'B004');
INSERT INTO LOAN VALUES ('L0005', 'C0009', 9500000, 'B005');
INSERT INTO LOAN VALUES ('L0006', 'C0008', 25000, 'B006');

-- Insert data into INSTALLMENT
INSERT INTO INSTALLMENT VALUES (1, 'L0005', 500000);
INSERT INTO INSTALLMENT VALUES (1, 'L0002', 10000);
INSERT INTO INSTALLMENT VALUES (1, 'L0003', 50000);
INSERT INTO INSTALLMENT VALUES (1, 'L0004', 20000);
INSERT INTO INSTALLMENT VALUES (2, 'L0005', 500000);
INSERT INTO INSTALLMENT VALUES (1, 'L0006', 3000);
INSERT INTO INSTALLMENT VALUES (2, 'L0002', 10000);
INSERT INTO INSTALLMENT VALUES (3, 'L0002', 10000);
INSERT INTO INSTALLMENT VALUES (2, 'L0003', 50000);
INSERT INTO INSTALLMENT VALUES (2, 'L0004', 20000);

COMMIT;
